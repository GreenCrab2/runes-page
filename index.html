<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Curse</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #000;
        cursor: none;
    }

    /* —— Центр — кнопка-лапа —— */
    #paw {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 240px;
        height: 240px;
        background: url('paw.png') center/contain no-repeat;
        cursor: pointer;
        transition: transform .2s ease;
    }
    #paw:hover {
        transform: translate(-50%, -50%) scale(1.08);
    }

    /* —— Глаз — контейнер —— */
    .eye {
        position: absolute;
        width: 180px;
        height: 180px;
        pointer-events: none;
        animation: appearDisappear 12s infinite ease-in-out;
    }

    /* глазное яблоко */
    .eye img {
        width: 100%;
        height: 100%;
        filter: drop-shadow(0 0 12px #00f2ff55);
    }

    @keyframes appearDisappear {
        0% { opacity: 0; transform: scale(.7); }
        10% { opacity: 1; transform: scale(1); }
        90% { opacity: 1; transform: scale(1); }
        100% { opacity: 0; transform: scale(.7); }
    }

    /* —— CRT выключение —— */
    #crt {
        position: fixed;
        inset: 0;
        background: #000;
        display: none;
        pointer-events: none;
    }
    .crt-off {
        display: block !important;
        animation: crtAnim 0.45s forwards;
    }

    @keyframes crtAnim {
        0% { opacity: 0; clip-path: inset(0 0 0 0); }
        40% { opacity: 1; clip-path: inset(48% 0 48% 0); }
        100% { opacity: 1; clip-path: inset(50% 0 50% 0); }
    }
</style>
</head>
<body>

<div id="paw"></div>
<div id="crt"></div>

<script>
/* ——————————————————————
   ЛИМИТЫ И НАСТРОЙКИ
—————————————————————— */
const EYE_COUNT = 20;
const EYES = [];
const EYE_SIZE = 180;
const SAFE_RADIUS = 250; // зона вокруг лапы
const MIN_DIST = 220;    // минимум между глазами

const paw = document.getElementById("paw");
const crt = document.getElementById("crt");

/* ——————————————————————
   СОЗДАЁМ ГЛАЗА
—————————————————————— */
function placeEyeSafely() {
    let x, y, safe = false;
    const sw = window.innerWidth;
    const sh = window.innerHeight;

    while (!safe) {
        x = Math.random() * (sw - EYE_SIZE);
        y = Math.random() * (sh - EYE_SIZE);

        // не лезть на лапу
        const dx = x - (sw/2 - EYE_SIZE/2);
        const dy = y - (sh/2 - EYE_SIZE/2);
        const distToPaw = Math.sqrt(dx*dx + dy*dy);
        if (distToPaw < SAFE_RADIUS) continue;

        // не пересекаться с другими глазами
        safe = true;
        for (let e of EYES) {
            const d2 = (e.x - x)**2 + (e.y - y)**2;
            if (d2 < MIN_DIST*MIN_DIST) {
                safe = false;
                break;
            }
        }
    }

    return { x, y };
}

function spawnEyes() {
    for (let i = 0; i < EYE_COUNT; i++) {
        const pos = placeEyeSafely();
        const el = document.createElement("div");
        el.className = "eye";
        el.style.left = pos.x + "px";
        el.style.top = pos.y + "px";

        el.innerHTML = `<img src="eye.png">`;
        document.body.appendChild(el);

        EYES.push({
            el,
            x: pos.x,
            y: pos.y
        });
    }
}
spawnEyes();

/* ——————————————————————
   ГЛАЗА СЛЕДЯТ ЗА КУРСОРОМ
—————————————————————— */
document.addEventListener("mousemove", e => {
    for (let eye of EYES) {
        const rect = eye.el.getBoundingClientRect();
        const cx = rect.left + rect.width/2;
        const cy = rect.top + rect.height/2;

        const dx = e.clientX - cx;
        const dy = e.clientY - cy;

        const angle = Math.atan2(dy, dx);
        const offset = 14; // сила смещения зрачка

        eye.el.firstChild.style.transform =
            `translate(${Math.cos(angle)*offset}px, ${Math.sin(angle)*offset}px)`;
    }
});

/* ——————————————————————
   КНОПКА — ВЫКЛЮЧЕНИЕ CRT
—————————————————————— */
paw.addEventListener("click", () => {
    crt.classList.add("crt-off");
    setTimeout(() => {
        // остаёмся на странице, просто темно
    }, 600);
});
</script>

</body>
</html>
